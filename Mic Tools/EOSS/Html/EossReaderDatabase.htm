<HTML>
	<HEAD>
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
		<TITLE></TITLE>
		<LINK href="EossReaderStyleSheet.css" type="text/css" rel="stylesheet" media="screen">
		<LINK href="EossReaderPrintStyleSheet.css" type="text/css" rel="stylesheet" media="print">
		<SCRIPT language="JavaScript" src="EossIncludes.js"></SCRIPT>
		<SCRIPT language="JavaScript">
		function window.onload()
		{
			try {
				SerialNumber.innerText = ISession.SerialNumber;

				var XPath = "//eoss/seal[@sn='" + ISession.SerialNumber+ "']/key";
				var Nodes = IDocument.selectNodes(XPath);
				var Plaintext = false;
				for (var i = 0; i < Nodes.length; i++)
				{
					var Node = Nodes.item(i);
					var Date = Node.getAttribute("date");
					var Time = Node.getAttribute("time");
					var Number = Node.getAttribute("no");
					if (Number != "")
					{
						var Row = Keysets.insertRow();
						var Cell = Row.insertCell();
						var Params = '"' + Number + '","' + Date + '","' + Time + '"';
						Cell.innerHTML = "<a onclick='Goto(" + Params + ")' href='#'>>> " + Number + " " + Date + " " + Time + "</a>";
					}
					else Plaintext = true;
				}
				if (Plaintext)
				{
					var Row = Keysets.insertRow();
					var Cell = Row.insertCell();
					var Params = '"","",""';
					Cell.innerHTML = "<a onclick='Goto(" + Params + ")' href='#'>>> Plain text data</a>";
				}
			}
			catch (e) {
				window.location.href ="EossReaderBlank.htm";
			}
		}
		function Goto(Number, Date, Time)
		{
			// store the current key-set node in a session variable...
			var XPath = "//eoss/seal[@sn='" + ISession.SerialNumber+ "']/key[@no='" + Number + "'][@date='" + Date + "'][@time='" + Time + "']"; 
			var KeysetNode = IDocument.selectSingleNode(XPath);
			if (KeysetNode) {
				ISession.SetValue("KeysetNode", KeysetNode);
				// and go to...
				window.location.href ="EossReaderDatabaseKeyset.htm"
			}
		}
		function Export()
		{
			IDocument.save("export.xml");
		}
		</SCRIPT>
	</HEAD>
	<BODY>
		<h1>EOSS S/N <span id="SerialNumber"></span>
		</h1>
		<table cellSpacing="0" cellPadding="0" width="100%">
			<tr>
				<td class="corner" width="5" height="5"><img src="ulsb.gif"></td>
				<td class="windowcaption"></td>
				<td class="corner" width="5" height="5"><img src="ursb.gif"></td>
			</tr>
			<tr class="windowcaption">
				<td width="5"></td>
				<td>Database</td>
				<td width="5"></td>
			</tr>
		</table>
		<table class="windowframe" cellSpacing="0" cellPadding="5" width="100%">
			<tr class="info">
				<td><b>Please select the key-set number and initialization time:</b></td>
			</tr>
			<tr class="info">
				<td>
					<table class="info" id="Keysets" cellSpacing="0" cellPadding="5" width="100%">
					</table>
				</td>
			</tr>
		</table>
	</BODY>
</HTML>
