<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
	<head>
		<title></title>
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
		<LINK href="EossReaderStyleSheet.css" type="text/css" rel="stylesheet" media="screen">
		<LINK href="EossReaderPrintStyleSheet.css" type="text/css" rel="stylesheet" media="print">
		<SCRIPT language="JavaScript" src="EossIncludes.js"></SCRIPT>
		<SCRIPT language="JavaScript">

			var Errors = 0;

			function window.onload()
			{
				try {
               // cursor shape
               Body.style.cursor = "wait";

					// complete the caption			
					GroupName.innerText = IGroup.Name;
				
					ISession.Canceled;	// clear by reading
					
					Progress(IGroup.Count, 0);
					
					for (var i = 0; i < IGroup.Count; i++)
					{
						try
						{
							if (ISession.Canceled) {
								window.location.href ="EossReaderGroup.htm";
								return;
							}
							var Seal = IGroup.Seal(i);
							Seal.GetChallenge();
							if (ISession.Canceled) {
								window.location.href ="EossReaderGroup.htm";
								return;
							}
							Seal.Logon();
							if (ISession.Canceled) {
								window.location.href ="EossReaderGroup.htm";
								return;
							}

							if (ISession.GetValue("Sync")) {
								Seal.Synchronize();
								if (ISession.Canceled) {
									window.location.href ="EossReaderGroup.htm";
									return;
								}
							}

							Seal.GetStatus();
							if (ISession.Canceled) {
								window.location.href ="EossReaderGroup.htm";
								return;
							}
							Seal.GetLogInfo();
							Seal.Readout(Seal.SealEvents, Seal.SystemEvents, 0);
							if (ISession.Canceled) {
								window.location.href ="EossReaderGroup.htm";
								return;
							}
							Seal.LogOff();
							if (ISession.Canceled) {
								window.location.href ="EossReaderGroup.htm";
								return;
							}
						}
						catch (e) {
							Errors++;
						}
						Progress(IGroup.Count, i + 1);
					}

               Body.style.cursor = "default";

					if (Errors)
						window.location.href ="EossReaderGroupReadoutError.htm";
					else
						window.location.href ="EossReaderGroupReport.htm";
				}
				catch (e) {
					window.location.href ="EossReaderBlank.htm";
				}
			}
			function Progress(Max, Pos)
			{
				var Text = new String("");
				for (var i = 0; i < Pos; i++)
				{
					Text += String.fromCharCode(0x2588); // block
				}
				for (i = Pos; i < Max; i++)
				{
					Text += String.fromCharCode(32); // space
				} 
				ProgressBar.innerText = Text;
				
				ProgressText.innerText = Pos + " of " + Max + " completed, " + Errors + " errors";
			}
		</SCRIPT>
	</head>
	<body id="Body">
		<h1><span id="GroupName"></span>
		</h1>
		<table cellSpacing="0" cellPadding="0" width="100%">
			<tr>
				<td width="5" height="5"><img src="ulsb.gif"></td>
				<td class="windowcaption"></td>
				<td width="5" height="5"><img src="ursb.gif"></td>
			</tr>
			<tr class="windowcaption">
				<td width="5"></td>
				<td>Group Interrogation in Progress</td>
				<td width="5"></td>
			</tr>
		</table>
		<table class="windowframe" cellSpacing="0" cellPadding="5" width="100%">
			<tr class="info">
				<td align="center">
					<p><b><span id="ProgressText"></span></b>
					</p>
				</td>
			</tr>
			<tr class="info">
				<td align="center">
					<p><span id="ProgressBar" class="progressbar"></span>
					</p>
				</td>
			</tr>
		</table>
	</body>
</html>
