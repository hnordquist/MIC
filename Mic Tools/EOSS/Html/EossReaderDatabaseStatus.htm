<HTML>
	<HEAD>
		<TITLE></TITLE>
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
		<LINK href="EossReaderStyleSheet.css" type="text/css" rel="stylesheet" media="screen">
		<LINK href="EossReaderPrintStyleSheet.css" type="text/css" rel="stylesheet" media="print">
		<SCRIPT language="JavaScript" src="EossIncludes.js"></SCRIPT>
		<SCRIPT language="JavaScript">
		function window.onload()
		{
			try {
				var KeysetNode = ISession.GetValue("KeysetNode");
				if (!KeysetNode) return;
				
				var SealNode = KeysetNode.parentNode;
				SerialNumber.innerText = SealNode.getAttribute("sn");

				var KeysetNumber = KeysetNode.getAttribute("no");
				Keyset.innerText = KeysetNumber;
				if (KeysetNumber) {
					Keyset.innerText = KeysetNumber;
				}
				else {
					Keyset.innerHTML = "<img src='excl.gif'> erased";
				}
				
				Initialization.innerText = KeysetNode.getAttribute("date") + " " + KeysetNode.getAttribute("time");

				var StatusNode = KeysetNode.selectSingleNode("./status/plain");

            if (StatusNode) {
               SealTime.innerText = StatusNode.getAttribute("date") + ' ' + StatusNode.getAttribute("time");
               var Operator1 = GetValue(StatusNode, 'operator1');
               var Operator2 = GetValue(StatusNode, 'operator2');
               if (!Operator1) Operator1 = "";
               if (!Operator2) Operator2 = "";
               operators.innerText = Operator1 + " " + Operator2;
               sealwire.innerText = GetValue(StatusNode, "sealwire");
               if (sealwire.innerText != "closed") wireimg.src = "excl.gif";
               protection.innerText = GetValue(StatusNode, "protection");
               if (protection.innerText != "safe") protimg.src = "excl.gif";
               housing.innerText = GetValue(StatusNode, "housing");
               if (housing.innerText != "closed") batcompimg.src = "excl.gif";
               extpower.innerText = GetValue(StatusNode, "ext-power");
               var Volts = GetValue(StatusNode, "bat-volts");
               batvolts.innerText = Volts + " V";
               if (Volts < 1.8) batvoltsimg.src = "excl.gif";
               var mAh = GetValue(StatusNode, "bat-consumed");
               batconsumed.innerText = mAh + " of 2000 mAh";
               if (mAh > 2000) batconsimg.src = "excl.gif";
               battype.innerText = GetValue(StatusNode, "bat-type");
               batid.innerText = GetValue(StatusNode, "bat-id");
               batmfg.innerText = GetValue(StatusNode, "bat-manufactured");
               batinst.innerText = GetValue(StatusNode, "bat-installed");
               ebatvolts.innerText = GetValue(StatusNode, "ebat-volts") + " V";
               ebatconsumed.innerText = GetValue(StatusNode, "ebat-consumed") + " of 170 mAh";
               ebatmfg.innerText = GetValue(StatusNode, "ebat-manufactured");
               ebatinst.innerText = GetValue(StatusNode, "ebat-installed");
               temperature.innerText = GetValue(StatusNode, "temperature") + " °C";
					vacenabled.innerText = GetValue(StatusNode, "vacenabled");
					vacattach.innerText = GetValue(StatusNode, "vacattach");               
               flashwarnings.innerText = GetValue(StatusNode, "flash-warnings");
               flasherrors.innerText = GetValue(StatusNode, "flash-errors");
               ramwarnings.innerText = GetValue(StatusNode, "ram-warnings");
               ramerrors.innerText = GetValue(StatusNode, "ram-errors");
            }
			}
			catch (e) {
				window.location.href ="EossReaderBlank.htm";
			}				
		}
		function GetValue(ParentNode, ValueName)
		{
			try {
				var ValueNode = ParentNode.selectSingleNode(ValueName);
				if (ValueNode) return ValueNode.text;
			}
			catch (e) {}			
			return "";
		}
		</SCRIPT>
	</HEAD>
	<body>
		<h1>EOSS S/N <span id="SerialNumber"></span>
		</h1>
		<table cellSpacing="0" cellPadding="0" width="100%">
			<tr>
				<td class="corner" width="5" height="5"><img src="ulsb.gif"></td>
				<td class="windowcaption"></td>
				<td class="corner" width="5" height="5"><img src="ursb.gif"></td>
			</tr>
			<tr class="windowcaption">
				<td width="5"></td>
				<td>Recent Seal Status</td>
				<td width="5"></td>
			</tr>
		</table>
		<table class="windowframe" cellSpacing="0" cellPadding="5" width="100%">
			<tr class="info">
				<td>
					<table class="info" cellSpacing="0" cellPadding="5" width="100%">
						<tr class="info">
							<td width="250">Key-set number:</td>
							<td id="Keyset"></td>
						</tr>
						<tr class="info">
							<td width="250">Seal initialization:</td>
							<td id="Initialization"></td>
						</tr>
						<tr class="info">
							<td width="250">Seal time:</td>
							<td id="SealTime">
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr class="info">
				<td>
					<table class="info" id="Details" cellSpacing="0" cellPadding="1" width="100%">
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">Operators:</td>
							<td id="operators" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"><img id="wireimg" src="void.gif"></dt>
							<td class="detail">Seal wire:</td>
							<td id="sealwire" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"><img id="protimg" src="void.gif"></dt>
							<td class="detail">Drill protection:</td>
							<td id="protection" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">External power:</td>
							<td id="extpower" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detailheader">Main battery</td>
							<td class="detailheader"></td>
						</tr>
						<tr class="info">
                     <td width="30"><img id="batcompimg" src="void.gif"></dt>
							<td class="detail">&nbsp;- Compartment:</td>
							<td id="housing" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"><img id="batvoltsimg" src="void.gif"></dt>
							<td class="detail">&nbsp;- Voltage:</td>
							<td id="batvolts" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"><img id="batconsimg" src="void.gif"></dt>
							<td class="detail">&nbsp;- Power consumed:</td>
							<td id="batconsumed" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Type:</td>
							<td id="battype" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- ID:</td>
							<td id="batid" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Manufactured:</td>
							<td id="batmfg" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Installed:</td>
							<td id="batinst" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detailheader">Emergency battery</td>
							<td class="detailheader"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Voltage:</td>
							<td id="ebatvolts" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"><img id="ebatimg" src="void.gif"></dt>
							<td class="detail">&nbsp;- Power consumed:</td>
							<td id="ebatconsumed" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Manufactured:</td>
							<td id="ebatmfg" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Installed:</td>
							<td id="ebatinst" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">Temperature:</td>
							<td id="temperature" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detailheader">VACOSS emulation</td>
							<td class="detailheader"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Enabled:</td>
							<td id="vacenabled" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Attachments:</td>
							<td id="vacattach" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detailheader">Flash memory</td>
							<td class="detailheader"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Warnings:</td>
							<td id="flashwarnings" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Errors:</td>
							<td id="flasherrors" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detailheader">Majority-vote memory</td>
							<td class="detailheader"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Warnings:</td>
							<td id="ramwarnings" class="detail"></td>
						</tr>
						<tr class="info">
                     <td width="30"></dt>
							<td class="detail">&nbsp;- Errors:</td>
							<td id="ramerrors" class="detail"></td>
						</tr>
					</table>
				</td>
			</tr>
			<tr class="info">
				<td>
					<table cellSpacing="1" cellPadding="5" width="100%">
						<tr class="menu">
							<td><a href="JavaScript:history.back(1)">&lt;&lt; Back</a>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
		<br>
	</body>
</HTML>
